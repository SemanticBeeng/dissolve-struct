<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>dissolve-struct by dalab</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>dissolve-struct</h1>
        <p>Distributed solver library for structured output prediction, based on Spark.</p>

        <p class="view"><a href="https://github.com/dalab/dissolve-struct">View the Project on GitHub <small>dalab/dissolve-struct</small></a></p>


        <ul>
          <li><a href="https://github.com/dalab/dissolve-struct/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/dalab/dissolve-struct/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/dalab/dissolve-struct">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p><a href="https://travis-ci.org/dalab/dissolve-struct"><img src="https://travis-ci.org/dalab/dissolve-struct.svg?branch=tuning" alt="Build Status"></a>
<a href="https://github.com/dalab/dissolve-struct/releases"><img src="https://img.shields.io/badge/release-v0.1-orange.svg" alt="Release status"></a></p>

<h1>
<a id="dissolvestruct" class="anchor" href="#dissolvestruct" aria-hidden="true"><span class="octicon octicon-link"></span></a>dissolve<sup>struct</sup>
</h1>

<p>Distributed solver library for structured output prediction, based on Spark.</p>

<p>The library is based on the primal-dual BCFW solver, allowing approximate inference oracles, and distributes this algorithm using the recent communication efficient CoCoA scheme.
The interface to the user is the same as in the widely used SVM<sup>struct</sup> in the single machine case.</p>

<h1>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h1>

<h4>
<a id="checkout-the-project-repository" class="anchor" href="#checkout-the-project-repository" aria-hidden="true"><span class="octicon octicon-link"></span></a>Checkout the project repository</h4>

<pre><code>git clone https://github.com/dalab/dissolve-struct.git
</code></pre>

<h2>
<a id="running-the-examples" class="anchor" href="#running-the-examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Running the examples</h2>

<p>Obtain the datasets using:</p>

<div class="highlight highlight-bash"><pre><span class="pl-s3">cd</span> data
bash retrieve_datasets.sh
python convert-ocr-data.py</pre></div>

<p>(you might have to install <code>brew install sbt</code> and <code>brew install wget</code> first if on a mac. Additionally, <code>pip -r requirements.txt</code> to obtain the python dependencies.)</p>

<p>The library and examples packages need to be built and packaged to execute the examples.
This can be done in two ways.</p>

<h5>
<a id="build-locally-using-sbt-recommended" class="anchor" href="#build-locally-using-sbt-recommended" aria-hidden="true"><span class="octicon octicon-link"></span></a>Build locally using sbt (Recommended)</h5>

<p>Build the solver package first:</p>

<div class="highlight highlight-bash"><pre><span class="pl-s3">cd</span> dissolve-struct-lib
sbt publish-local</pre></div>

<p>Followed by building the example package:</p>

<div class="highlight highlight-bash"><pre><span class="pl-s3">cd</span> dissolve-struct-examples
sbt package</pre></div>

<h5>
<a id="obtain-packaged-binaries" class="anchor" href="#obtain-packaged-binaries" aria-hidden="true"><span class="octicon octicon-link"></span></a>Obtain packaged binaries</h5>

<p>The binaries for both the solver and the examples package can be obtained at the <a href="https://github.com/dalab/dissolve-struct/releases">releases</a> page.</p>

<p>But be warned, these binaries might not be up-to-date since the project is still in the development stage.</p>

<h3>
<a id="executing-through-command-line" class="anchor" href="#executing-through-command-line" aria-hidden="true"><span class="octicon octicon-link"></span></a>Executing through command line</h3>

<p>Download the <a href="http://spark.apache.org/downloads.html">pre-build binary package of Spark</a>. Here for example we assume the Spark folder is named <code>spark-1.2.0</code>.</p>

<h5>
<a id="binary-classification-example" class="anchor" href="#binary-classification-example" aria-hidden="true"><span class="octicon octicon-link"></span></a>Binary classification Example</h5>

<p>Training a binary SVM locally from the command-line is done as follows, here for the Forest Cover (COV) dataset. Within <code>dissolve-struct-examples</code> directory, run</p>

<div class="highlight highlight-bash"><pre>spark-1.2.0/bin/spark-submit --jars ../dissolve-struct-lib/target/scala-2.10/dissolvestruct_2.10-0.1-SNAPSHOT.jar --class <span class="pl-s1"><span class="pl-pds">"</span>ch.ethz.dalab.dissolve.examples.binaryclassification.COVBinary<span class="pl-pds">"</span></span> --master <span class="pl-s">local</span> --driver-memory 2G target/scala-2.10/dissolvestructexample_2.10-0.1-SNAPSHOT.jar</pre></div>

<h5>
<a id="sequence-prediction-with-ocr-data" class="anchor" href="#sequence-prediction-with-ocr-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sequence Prediction with OCR data</h5>

<p>Training a chain structured SVM model on the <a href="http://www.seas.upenn.edu/%7Etaskar/ocr/">OCR dataset</a>. This example uses the Viterbi algorithm for the decoding oracle:</p>

<div class="highlight highlight-bash"><pre>spark-1.2.0/bin/spark-submit --jars ../dissolve-struct-lib/target/scala-2.10/dissolvestruct_2.10-0.1-SNAPSHOT.jar --class <span class="pl-s1"><span class="pl-pds">"</span>ch.ethz.dalab.dissolve.examples.chain.ChainDemo<span class="pl-pds">"</span></span> --master <span class="pl-s">local</span> --driver-memory 2G target/scala-2.10/dissolvestructexample_2.10-0.1-SNAPSHOT.jar</pre></div>

<p>Here is the same example using more general Belief Propagation, by employing the <a href="http://factorie.cs.umass.edu/">Factorie library</a> (Requires <a href="https://github.com/factorie/factorie/releases">Factorie 1.0 Jar</a> to be placed within <code>dissolve-struct-examples/lib</code> directory):</p>

<div class="highlight highlight-bash"><pre>spark-1.2.0/bin/spark-submit --jars ../dissolve-struct-lib/target/scala-2.10/dissolvestruct_2.10-0.1-SNAPSHOT.jar,lib/factorie-1.0.jar --class <span class="pl-s1"><span class="pl-pds">"</span>ch.ethz.dalab.dissolve.examples.chain.ChainBPDemo<span class="pl-pds">"</span></span> --master <span class="pl-s">local</span> --driver-memory 2G target/scala-2.10/dissolvestructexample_2.10-0.1-SNAPSHOT.jar</pre></div>

<h3>
<a id="executing-within-eclipse" class="anchor" href="#executing-within-eclipse" aria-hidden="true"><span class="octicon octicon-link"></span></a>Executing within Eclipse</h3>

<p>To ease debugging and development, the examples can directly be run within Eclipse by <code>Run As | Scala Application</code>. This does not require Spark binaries. See the section below how to set up the environment.</p>

<p>Within Eclipse, Spark can only be run in local mode since all the interactions need to be visible to Eclipse.
In order to enable this, the <code>SparkContext</code> needs to be initialized by setting the master to <code>local</code>:</p>

<div class="highlight highlight-scala"><pre><span class="pl-k">val</span> <span class="pl-en">conf</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">SparkConf</span>()
           .setAppName(<span class="pl-s1"><span class="pl-pds">"</span>COV-example<span class="pl-pds">"</span></span>)
           .setMaster(<span class="pl-s1"><span class="pl-pds">"</span>local[4]<span class="pl-pds">"</span></span>)</pre></div>

<h2>
<a id="setting-up-a-development-environment" class="anchor" href="#setting-up-a-development-environment" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setting up a development environment</h2>

<p>To import the packages in <a href="http://scala-ide.org/download/sdk.html">Eclipse for Scala</a>, the respective .classpath files needs to be generated for the <code>dissolve-struct-lib</code>:</p>

<div class="highlight highlight-bash"><pre><span class="pl-s3">cd</span> dissolve-struct-lib
sbt eclipse</pre></div>

<p>Similarly, for <code>dissolve-struct-examples</code> package too:</p>

<div class="highlight highlight-bash"><pre><span class="pl-s3">cd</span> dissolve-struct-examples
sbt eclipse</pre></div>

<p>The above packages can be imported individually into Eclipse using: <code>File | Import | Existing Projects into Workspace</code>. Make sure you have <code>search for nested projects</code> checked, so you'll have the choice to select both the <code>dissolve-struct-lib</code> and <code>dissolve-struct-examples</code> projects, if desired.</p>

<p>Currently Scala 2.10.4 is required by Spark. If Eclipse defaults to Scala 2.11 instead, this can cause an error "cross-compiled with an incompatible version of Scala".
The correct version needs to be set for both the projects by:
<code>Project Properties | Scala Compiler | Setting "Scala Installation" to "Latest 2.10 bundle"</code>.
Alternatively, we recommend directly working with Eclipse IDE for Scala 2.10.4 from <a href="http://scala-ide.org/download/sdk.html">http://scala-ide.org/download/sdk.html</a>.</p>

<h2>
<a id="references" class="anchor" href="#references" aria-hidden="true"><span class="octicon octicon-link"></span></a>References</h2>

<p>The CoCoA algorithmic framework is described in the following paper:</p>

<ul>
<li>
<p><em>Jaggi, M., Smith, V., Takac, M., Terhorst, J., Krishnan, S., Hofmann, T., &amp; Jordan, M. I. (2014) <a href="http://papers.nips.cc/paper/5599-communication-efficient-distributed-dual-coordinate-ascent">Communication-Efficient Distributed Dual Coordinate Ascent</a> (pp. 3068–3076). NIPS 2014 - Advances in Neural Information Processing Systems 27.</em></p>

<p>see also the binary classification and regression <a href="https://github.com/gingsmith/cocoa">spark code here</a>.</p>
</li>
</ul>

<p>The (single machine) BCFW algorithm for structured prediction is described in the following paper:</p>

<ul>
<li><em>Lacoste-Julien, S., Jaggi, M., Schmidt, M., &amp; Pletscher, P. (2013) <a href="http://jmlr.org/proceedings/papers/v28/lacoste-julien13">Block-Coordinate Frank-Wolfe Optimization for Structural SVMs</a>. ICML 2013 - Proceedings of the 30th International Conference on Machine Learning.</em></li>
</ul>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/dalab">dalab</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>